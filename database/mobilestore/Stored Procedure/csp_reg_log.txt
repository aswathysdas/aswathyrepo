delimiter //
create procedure csp_reg_log(in email varchar(40),in pasword varchar(40),in fnm varchar(30),in lnm varchar(30),in addrs varchar(30),in pincode int(20),in mbnum varchar(40))
begin
declare done int default 0;
declare a int default 0;
declare dat date;
declare continue handler for sqlexception,sqlwarning set done=1;

start transaction;
insert into tbl_login(vchr_email,vchr_password,fk_int_user_role_id) values (email,pasword,2);
set a=(select last_insert_id());
set dat=CURDATE();
insert into tbl_registration(vchr_fname,vchr_lname,vchr_address,int_pincode,int_mobilenum,fk_int_login_id,dat_date) 
values(fnm,lnm,addrs,pincode,mbnum,a,dat);
if done=0 then
COMMIT;
else
ROLLBACK;
end if;
end//